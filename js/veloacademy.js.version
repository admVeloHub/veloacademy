# Versionamento - veloacademy.js
# Formato: vX.Y.Z onde X=versão maior, Y=versão menor, Z=versão de correção

## v1.9.4 - 2025-01-30
- CORREÇÃO CRÍTICA: Título da aula agora usa subtítulo da seção ao invés de títulos dos vídeos
- Formato fixo: "Aula - [Nome da Seção]" (ex: "Aula - Seguro Celular")
- Não depende mais dos títulos individuais dos vídeos
- Título da aula sempre consistente e baseado na seção

## v1.9.3 - 2025-01-30
- CORREÇÃO: Título de vídeos agrupados agora mostra título único quando todos têm o mesmo título
- Quando múltiplos vídeos têm o mesmo título (ex: "Aula - Seguro Celular"), exibe apenas o título único
- Evita exibição de "5 vídeos: Aula - Seguro Celular, Aula - Seguro Celular, ..."
- Melhora na apresentação visual dos botões de sequência de vídeos

## v1.9.2 - 2025-01-30
- ADIÇÃO: Quiz configurado para seção "Seguro Celular"
- Adicionado "Seguro Celular" à lista de seções com quiz habilitado
- Quiz ID configurado como "seguro_celular" conforme solicitado
- Botão "Fazer Quiz" agora aparece na seção Seguro Celular após completar vídeos
- Integração completa com sistema de quizzes existente

## v1.9.1 - 2025-01-30
- CORREÇÃO CRÍTICA: Corrigido erro "headerClass is not defined" na função openCourse()
- Variável headerClass agora é definida corretamente antes de ser usada
- CORREÇÃO: Função validateLink() atualizada para detectar links do YouTube corretamente
- validateLink() agora também rejeita links "#" e strings vazias como inválidos
- Cards de cursos agora funcionam corretamente ao serem clicados

## v1.9.0 - 2025-01-30
- FUNCIONALIDADE: Ocultar título e subtítulo no curso "produtos"
- Modificada função openCourse() para detectar curso "produtos" e não renderizar course-title-section
- Adicionada classe CSS "no-title" ao header quando não há título
- ALTERAÇÃO: Texto do botão voltar alterado de "Voltar para Cursos" para apenas "Voltar"
- ATUALIZAÇÃO: renderCourses() atualizado para incluir novo curso "novidades-modificacoes"
- ATUALIZAÇÃO: getCourseType() atualizado para retornar "Atualização" para curso "novidades-modificacoes"
- Mantida compatibilidade com cursos existentes

## v1.8.0 - 2025-01-30
- ADIÇÃO: Sistema de modal YouTube com player embedded
- Funções adicionadas: isYouTubeLink(), extractYouTubeId(), openYouTubeModal(), closeYouTubeModal(), createYouTubeModal()
- Detecção automática de links YouTube (formatos: youtube.com/watch, youtu.be, youtube.com/embed)
- Botão "Assistir" detecta YouTube e abre modal ao invés de nova aba
- Modal com overlay escuro, animações suaves e responsividade completa
- Suporte a tema escuro seguindo LAYOUT_GUIDELINES.md
- Event listeners para fechar modal (overlay, ESC, botão X)
- Vídeo pausa automaticamente ao fechar modal
- Compatibilidade 100% mantida com sistema Google Drive existente
- Modificadas funções de renderização (seções com sections e estrutura antiga)

## v1.7.0 - 2024-12-19
- SEGURANÇA: Sistema de logs seguros implementado
- Adicionadas funções: isDeveloperUser(), secureLog(), sanitizeSensitiveData(), secureScoreLog()
- Logs sensíveis (respostas corretas, pontuação, mapeamentos) visíveis apenas para Lucas Gravina
- Usuários comuns veem logs sanitizados sem dados confidenciais
- Substituídos console.log sensíveis por secureLog() em todas as funções críticas
- FUNCIONALIDADE: Questões erradas exibidas na tela de aprovação
- Candidatos aprovados veem lista de questões que erraram para revisão
- Implementado em showQuizResult() e showLocalQuizResult()
- Seção "Questões para Revisão" com design consistente com VeloHub
- Suporte completo a tema claro/escuro e responsividade mobile

## v1.6.1 - 2024-12-19
- OTIMIZAÇÃO: Formato de envio simplificado para melhor performance
- Removidos campos desnecessários: score, totalQuestions, passingScore
- Formato final: action, name, email, courseId, approved, finalGrade, wrongQuestions
- Redução significativa no tamanho dos dados enviados
- Melhoria na velocidade de transmissão e processamento

## v1.6.0 - 2024-12-19
- CORREÇÃO CRÍTICA: Simplificação completa do sistema de envio de quiz
- Removidos logs excessivos que poluíam o console
- Corrigido envio duplicado - agora envia apenas uma vez ao finalizar
- Criada função showQuizResult() para exibir resultado de forma limpa
- Simplificada função returnToCourse() - removido envio duplicado
- Simplificada função generateCertificate() - usa dados armazenados
- Adicionadas variáveis quizResult e certificateUrl para armazenar estado
- Fluxo otimizado: Finalizar → Enviar → Mostrar resultado → Ações
- Resolvido problema de processamento triplicado no mesmo fluxo
- Sistema mais eficiente e com menos logs desnecessários

## v1.5.16 - 2024-12-19
- CORREÇÃO: Lógica de envio de wrongQuestions para aprovados
- Removida condição isReproved/approved das funções submitQuizToAppsScript e generateCertificate
- Agora envia questões erradas sempre que houver, independente da aprovação
- Logs atualizados para refletir nova lógica
- Consistência total entre envio de quiz e geração de certificado

## v1.5.15 - 2024-12-19
- CORREÇÃO: ID do quiz "Comunicação que Conecta" corrigido
- Alterado de "exc-atendimento" para "Exc Atendimento" (com espaço e maiúscula)
- Quiz agora busca corretamente no Google Apps Script
- Resolvido erro de "Curso não encontrado" para o quiz de atendimento

## v1.5.14 - 2024-12-19
- MELHORIA: Envio de wrongQuestions para aprovados e reprovados
- Removida condição isReproved da lógica de envio de wrongQuestions
- Agora envia questões erradas sempre que houver, independente da aprovação
- Melhoria na análise de performance dos candidatos
- Logs mantidos para rastreamento de questões incorretas

## v1.5.13 - 2024-12-19
- CORREÇÃO: Adicionado "Comunicação que Conecta" à condição de exibição do botão de quiz
- Botão "Fazer Quiz" agora aparece corretamente na seção "Comunicação que Conecta"
- Quiz "exc-atendimento" funcional e integrado ao sistema
- Correção na lógica de renderização dos botões de quiz

## v1.5.12 - 2024-12-19
- ADIÇÃO: Mapeamento do quiz "exc-atendimento" para seção "Comunicação que Conecta"
- Novo módulo "Atendimento ao Cliente" agora possui botão de quiz funcional
- Quiz integrado com sistema existente usando mesmo padrão dos outros quizzes
- ID do quiz: exc-atendimento (já configurado no Google Apps Script)

## v1.5.11 - 2024-12-19
- ADAPTAÇÃO: Frontend adaptado para novo formato de JSON do backend
- Removidos parâmetros: answers, answerMappings (não mais necessários)
- Adicionado parâmetro: nota (calculada pelo frontend)
- Mantido parâmetro: wrongQuestions (apenas em reprovação)
- Mantido parâmetro: callback (obrigatório para JSONP)
- Formato final: {action, name, email, courseId, nota, wrongQuestions?, callback}
- Backend agora recebe nota calculada pelo frontend

## v1.5.10 - 2024-12-19
- CORREÇÃO URGENTE: Corrigido courseId do quiz Seguro Prestamista para camelCase
- Alterado de "seguro-presta-ct" para "seguroPrestaCt" (camelCase)
- Corrigido "credito-pessoal" para "creditoPessoal" (camelCase)
- Atualizado mapeamento de títulos no getCourseTitle()
- Corrigido quizCourseId na lógica de exibição de botões de quiz
- Todos os courseIds agora seguem padrão camelCase
- Quiz do Seguro Prestamista agora carrega corretamente com backend
- Resolvido erro "Curso não encontrado" no frontend

## v1.6.2 - 2024-12-19
- CORREÇÃO CRÍTICA: Função returnToCourse() agora envia dados de reprovação para o Apps Script
- Quando usuário reprova e clica "Voltar ao curso", dados são enviados antes de voltar
- Calcula pontuação e questões erradas automaticamente
- Chama submitQuizToAppsScript() para registrar reprovação no backend
- Resolvido problema de dados de reprovação não serem enviados

## v1.6.1 - 2024-12-19
- CORREÇÃO CRÍTICA: Corrigido erro "score is not defined" na função showLocalQuizResult
- Adicionado parâmetro score na chamada da função showLocalQuizResult
- Função agora recebe: showLocalQuizResult(score, finalGrade, passingScore, totalQuestions)
- Resolvido erro de referência que impedia exibição do resultado local

## v1.6.0 - 2024-12-19
- ALTERAÇÃO CRÍTICA: Mudança do critério de aprovação de nota proporcional para número de acertos
- ANTES: finalGrade >= passingScore (nota de 0-10)
- DEPOIS: score >= passingScore (número de acertos)
- Atualizada mensagem de feedback para mostrar acertos/total
- Fallback inteligente: 70% das questões quando passingScore não definido
- Aplicado em todas as funções de verificação de aprovação (submitQuizToAppsScript, showLocalQuizResult, calculateQuizResult)

## v1.5.9 - 2024-12-19
- OTIMIZAÇÃO: Envio de questões erradas apenas em caso de reprovação
- Modificada lógica de submitQuizToAppsScript() para calcular pontuação antes do envio
- Parâmetro wrongQuestions adicionado condicionalmente apenas para reprovações
- Modificada lógica de generateCertificate() para incluir questões erradas apenas se reprovado
- Redução de tráfego de rede - dados desnecessários não são enviados em aprovações
- Logs otimizados para distinguir entre aprovações e reprovações
- Performance melhorada mantendo funcionalidade completa

## v1.5.8 - 2024-12-19
- Implementado log de reprovações no frontend
- Adicionada função calculateWrongQuestions() para identificar questões erradas
- Modificada função submitQuizToAppsScript() para incluir parâmetro wrongQuestions
- Modificada função generateCertificate() para incluir questões erradas na URL
- Array de questões erradas enviado como JSON string para o backend
- Logs detalhados para rastreamento de questões incorretas
- Compatibilidade mantida com sistema de correção existente

## v1.5.7 - 2024-12-19
- Adicionado suporte ao quiz do Seguro Prestamista (ID: seguro-presta-ct)
- Incluído mapeamento de título para o novo quiz no getCourseTitle()
- Atualizada lógica de exibição de botões de quiz para incluir Seguro Prestamista
- Mantida compatibilidade com sistema de quizzes existente
- Integração completa com Google Apps Script para novo quiz

## v1.5.6 - 2024-12-19
- Correção crítica: Validação de correctAnswer válido (0-3)
- Implementado fallback quando correctAnswer é -1 ou inválido
- Fallback: primeira opção (índice 0) como resposta correta
- Sistema robusto para lidar com Apps Script mal configurado
- Logs de debug para rastreamento de fallbacks aplicados

## v1.5.5 - 2024-12-19
- Correção crítica: Função de callback JSONP para processar resposta correta
- Alterado data.status para data.success na verificação de sucesso
- Corrigido acesso aos dados: data.quiz.questions em vez de data.questions
- Corrigido campo de resposta: question.correctAnswer em vez de question.answer
- Sistema de quiz agora funcional com o novo formato de resposta do Apps Script

## v1.5.4 - 2024-12-19
- Alteração da URL de envio para action=downloadCertificate
- Removido parâmetro approved da URL (não mais necessário)
- URL otimizada para download direto do certificado
- Parâmetros mantidos: name, email, courseId, score, totalQuestions, finalGrade

## v1.5.3 - 2024-12-19
- Alteração da URL de envio para action=submitResult
- Novos parâmetros: score, totalQuestions, finalGrade, approved
- Removidos parâmetros: answers, answerMappings (não mais necessários)
- Cálculo de pontuação integrado na função generateCertificate()
- URL simplificada e otimizada para o novo backend

## v1.5.2 - 2024-12-19
- Correção crítica: URL do certificado agora inclui answerMappings
- Adicionado parâmetro answerMappings na função generateCertificate()
- Logs de debug adicionados para verificação do mapeamento no certificado
- URL do certificado agora completa com todos os parâmetros necessários
- Prioridade ALTA: Sistema de certificados agora funcional

## v1.5.1 - 2024-12-19
- Correção do formato do answerMappings para compatibilidade com backend
- Alterado de formato de array para objeto de mapeamento de índices
- Adicionado armazenamento de optionMappings no currentQuiz
- Logs de debug adicionados para verificação do mapeamento
- Formato correto: {"0": 2, "1": 0, "2": 3, "3": 1} (índice randomizado -> índice original)

## v1.5.0 - 2024-12-19
- Implementação completa do sistema JSONP para integração com Google Apps Script
- Substituição de fetch() por JSONP para contornar limitações de CORS
- Novas funções: loadQuizFromAppsScript() via JSONP, submitQuizToAppsScript() via JSONP, testCORS()
- URLs JSONP configuradas: getQuizJSONP, submitQuizJSONP, testCORS
- Sistema de callbacks dinâmicos com limpeza automática
- Fallback local mantido para casos de erro
- Compatibilidade total com servidor Google Apps Script

## v1.4.2 - 2024-12-19
- Atualizada URL do Google Apps Script para novo deploy
- Nova URL: AKfycbyLR1pyRoBjSivGP5xrDTD7DZeJCCpKF868qlSaKZC1u3srLIMJkwiQ5R8RZpD_tsCqCQ
- Servidor VeloAcademy confirmado no ar

## v1.4.1 - 2024-12-19
- Alterada etiqueta do curso "Produtos Velotax" de "Atualização" para "Essencial"
- Ambos os cursos principais (Onboarding e Produtos) agora são marcados como "Essencial"
- Mantida estrutura e funcionalidade dos quizzes

## v1.4.0 - 2024-12-19
- Reformulação da estrutura do curso Produtos Velotax
- Atualizados dados de fallback com nova organização em 2 módulos
- Módulo 1: Produtos de Crédito com 4 subtítulos
- Módulo 2: Produtos para Investidores com 3 subtítulos
- Mantida compatibilidade com sistema de quizzes por subtítulos
- Estrutura mais organizada e intuitiva

## v1.3.0 - 2024-12-19
- Adicionado suporte ao novo curso "Produtos Velotax"
- Atualizada função getCourseType para incluir etiqueta "Atualização" para produtos
- Modificada lógica de exibição para mostrar cursos onboarding e produtos
- Atualizados dados de fallback com nova estrutura de cursos
- Mantida compatibilidade com sistema existente
- Reorganização dos módulos conforme nova estrutura

## v1.2.0 - 2024-12-19
- Sistema de autenticação integrado
- Verificação de domínio autorizado (@velotax.com.br)
- Gerenciamento de sessão com expiração
- Integração com Google Sign-In
- Sistema de progresso e conquistas

## v1.1.0 - 2024-12-19
- Sistema de cursos implementado
- Integração com Google Drive
- Sistema de módulos e lições
- Interface responsiva
- Sistema de busca e filtros

## v1.0.0 - Versão inicial
- Estrutura base do VeloAcademy
- Sistema de navegação
- Interface de usuário básica